
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sureway MeMart Africa ‚Äì Escrow Demo (Stacks Testnet)</title>
  <script src="https://unpkg.com/@stacks/connect@latest/dist/stacks-connect.umd.js"></script>
  <script src="https://unpkg.com/@stacks/transactions@latest/dist/index.umd.js"></script>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: linear-gradient(180deg, #002366, #ffd700);
      color: #fff;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    header {
      padding: 20px;
      background-color: rgba(0,0,0,0.2);
    }
    img.logo {
      height: 90px;
      margin-bottom: 10px;
    }
    main {
      margin: 20px auto;
      max-width: 600px;
      background: rgba(255,255,255,0.1);
      border-radius: 15px;
      padding: 20px;
    }
    button {
      background: #ffd700;
      color: #002366;
      border: none;
      padding: 12px 20px;
      margin: 10px;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
    }
    pre {
      background: rgba(0,0,0,0.3);
      color: #fff;
      padding: 10px;
      border-radius: 8px;
      overflow-x: auto;
      text-align: left;
    }
    footer {
      margin-top: 20px;
      font-size: 13px;
      background-color: rgba(0,0,0,0.2);
      padding: 10px;
    }
  </style>
</head>
<body>
  <header>
    <img src="Sureway-logo.png" alt="Sureway Logo" class="logo" />
    <h2>Sureway MeMart Africa Escrow Demo</h2>
    <p>Blockchain-powered logistics & payment solution (Stacks Testnet)</p>
  </header>

  <main>
    <h3>Escrow Smart Contract (Simulated)</h3>
    <pre id="clarity-contract">
// sureway-escrow.clar
(define-public (deposit (receiver principal) (amount uint))
  (begin
    (print {action: "deposit", to: receiver, amount: amount})
    (ok true)))

(define-public (confirm-delivery)
  (begin
    (print {action: "confirm-delivery"})
    (ok true)))

(define-public (refund)
  (begin
    (print {action: "refund"})
    (ok true)))
    </pre>

    <h3>Transaction Simulation</h3>
    <p><strong>Seller:</strong> ST2W71F29DDHZRCAT6FTWQ7N5HA44X6RG1MY8QRSC<br>
    <strong>Amount:</strong> 200 STX<br>
    <strong>Buyer Wallet:</strong> Connect below</p>

    <button id="connectWallet">üîó Connect Leather Wallet</button>
    <button id="depositBtn" disabled>üí∞ Deposit 200 STX</button>
    <button id="confirmBtn" disabled>‚úÖ Confirm Delivery</button>
    <button id="refundBtn" disabled>‚Ü©Ô∏è Refund</button>

    <div id="status" style="margin-top:15px;font-size:14px;"></div>
  </main>

  <footer>
    ¬© 2025 Sureway Integrated Technology Solutions Limited RC 8481374<br>
    Abdulazeez Yusuf ‚Äî Founder & CEO<br>
    Microsoft Build 2025 | Microsoft Ignite 2025 | 3MTT Cohort 3 Fellow (No-Code Azure ML)<br>
    WEF SDIM25 | WEF Insight 25 | WEF Cities of Mayors 25 | WEF SME Candidate 25
  </footer>

  <script>
    const { AppConfig, UserSession, showConnect } = window["@stacks/connect"];
    const { openContractCall, AnchorMode, makeStandardSTXPostCondition, PostConditionMode, FungibleConditionCode } = window["@stacks/transactions"];

    const appConfig = new AppConfig(['store_write']);
    const userSession = new UserSession({ appConfig });

    const connectWallet = document.getElementById("connectWallet");
    const depositBtn = document.getElementById("depositBtn");
    const confirmBtn = document.getElementById("confirmBtn");
    const refundBtn = document.getElementById("refundBtn");
    const statusDiv = document.getElementById("status");

    let connectedAddress = null;

    connectWallet.onclick = async () => {
      showConnect({
        userSession,
        appDetails: {
          name: "Sureway MeMart Africa",
          icon: "Sureway-logo.png",
        },
        onFinish: () => {
          const userData = userSession.loadUserData();
          connectedAddress = userData.profile.stxAddress.testnet;
          statusDiv.innerHTML = `‚úÖ Connected: ${connectedAddress}`;
          depositBtn.disabled = false;
          confirmBtn.disabled = false;
          refundBtn.disabled = false;
        },
      });
    };

    async function simulateTx(action) {
      const time = new Date().toLocaleTimeString();
      statusDiv.innerHTML += `<br>[${time}] ${action} action triggered. Broadcasting simulated testnet transaction...`;
      await new Promise(r => setTimeout(r, 2000));
      statusDiv.innerHTML += `<br>‚úÖ ${action} completed on Stacks testnet.`;
    }

    depositBtn.onclick = () => simulateTx("Deposit 200 STX");
    confirmBtn.onclick = () => simulateTx("Confirm Delivery");
    refundBtn.onclick = () => simulateTx("Refund to Buyer");
  </script>
</body>
</html>
